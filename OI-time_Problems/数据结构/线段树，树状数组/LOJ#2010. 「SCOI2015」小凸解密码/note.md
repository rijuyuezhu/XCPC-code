可以将原序列先倍长。

首先，显然修改操作只会修改 $O(1)$ 个位置的值，主要看询问。

询问，可以先二分一个距离 $d$，看看是否存在零区间距离 $B_0$ 大于等于 $d$。这等价于在题述的展开方式下，在区间 $[num+d-1,num+n-d+1]$ 中存在全 0 子段（并且不触碰到区间边界）。用线段树维护 $B$ 的每个区间内是否存在这样的子段即可。当然，要特判 $d=0$。