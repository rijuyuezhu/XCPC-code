做法由 [这题](https://www.luogu.com.cn/problem/CF504E) 推广而来。


1. 前缀哈希值

已知一个字符串 $s=s_1s_1\cdots s_n$，定义 $i$ 的 **前缀进制哈希** 为将前 $i$ 位看作是一个 $B$ 进制数（其中 $s_i$ 是最低位）,即 $pre_i=\sum_{j=1}^is_iB^{i-j}$。

若要往后面加字符 $c$，则类似于快读中的写法，$pre_{n+1}=pre_n \times B + c$。

若要往前面加字符 $c$，则直接置最高位， $pre_n'=pre_n \times B^n$。

要得到子串 $(i,j)$ 的前缀进制哈希，有 $hash=pre_j-pre_{i-1}\times B^{j-i+1}$

2. 后缀哈希值

类似定义。这里特别讲一下得到子串 $(i,j)$ 的后缀哈希值的方法：$hash=(suf_i-suf_{j+1})\times\dfrac{1}{B^{n-j}}$。

哈希在应用中值得注意的几点：

1. 模数最好选择 $10^8\sim 10^9$ 级别的大质数（不要选常见的），B 可以稍微小一点。
2. 在 cf 上最好使用双哈希。
3. 使用时需要预处理 B 的幂和 B 逆元的幂。