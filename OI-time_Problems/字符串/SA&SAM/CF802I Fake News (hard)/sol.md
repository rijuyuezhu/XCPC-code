建 sam，最后答案

$$
\sum_{u}sz_u^2(\mathrm{maxlen}(u)-\mathrm{minlen}(u)+1)
$$

tip：求 $sz$ 可以不建 parent tree，按照 len 排序即可。 可以用基数排序。