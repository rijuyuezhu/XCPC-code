# 分拆数 学习笔记 | P6189 [NOI Online #1 入门组] 跑步 解题报告

[P6189 [NOI Online #1 入门组] 跑步](https://www.luogu.com.cn/problem/P6189)

## 问题1

多次询问，每次询问把 $n$ 不计顺序地拆分为若干（可相同）正整数之和的方案数。

### 思路1

我们令 $f(n,k)$ 表示将 $n$ 拆分成若干 $\le k$ 的正整数数的方案数。

则
$$
f(n,k)=f(n,k-1)+f(n-k,k)
$$
讨论分的方案中有没有 $k$，若没有 $k$ ，则直接在 $\le k-1$ 的数中选；若有 $k$，则先拿掉一个 $k$。

通过这个我们也可以解决一个附加的问题：把 $n$ 不计顺序地拆分为若干（可相同）$\le m$ 的正整数之和的方案数。

时间复杂度 $O(n^2)$

### 思路2

令 $g(n,k)$ 表示将 $n$ 拆分成 $k$ 个数的方案数。

则
$$
g(n,k)=g(n-k,k)+g(n-1,k-1)
$$
讨论分的数中有没有1。如果没有1，则把所有数-1再统计；如果有1，直接把1拿掉。

通过这个我们也可以解决一个附加的问题：把 $n$ 不计顺序地拆分为 $k$ 个（可相同）正整数之和的方案数。

### 思路3

根据思路1和思路2，我们可以值域分块考虑。设值域最大为 $V$，$m=\left\lfloor\sqrt V\right\rfloor$

由于 $n$ 的分拆中最多有 $\sqrt n$ 个大于 $\sqrt n$ 的数，所以我们结合两种做法。

一、当 $n\le \sqrt V$ 。我们直接预处理 $f(\cdot,k),k \le m$ 即可，这一部分时间复杂度为 $O(V\sqrt V)$。

二、当 $n>\sqrt V$ 。

我们设 $g(n,k)$ 表示将 $n$ 拆分成 $k$ 个 $\ge m$ 的数的方案数。则递推公式同上，而 $k$ 至多到 $\sqrt V$。然后考虑怎么求解答案。

考虑把 $n$ 搞成两部分求解。

答案为
$$
\sum_{j=0}^n\left(f(j,m-1)\times \sum_{i=0}^mg(n-j,i)\right)
$$
时间复杂度为 $O(n\sqrt n)$.

