# prufer序列 学习笔记

$1\sim n$ 的有标号无根树可以与 $[1,n]$ 中的 $n-2$ 个整数构成的序列形成双射。其中一种构造方法就是 prufer 序列。

## 1. 构造

prufer序列如下构造：

每次选择一个编号最小的叶节点并删掉它，然后在序列中记录下它连接到的那个节点。重复 $n-2$ 次后就剩下两个节点。其中有一个是节点 $n$。

$O(n)$ 的构造方法：用指针 $p$ 指向当前编号最小的叶子节点。每次把 $p$ 对应节点删去后，若产生了新的叶子 $x$ （显然最多产生一个叶子）：

- 若 $x<p$，则 $x$ 成为了新的最小节点，继续删去，重复该过程。
- 否则，在之后 $p$ 会遍历到 $x$，继续遍历即可。

## 2. 性质

根据构造的过程，prufer序列有以下显然的性质：

一个在原树中度数为 $d$ 的节点在 prufer 序列中出现 $d-1$ 次。

## 3. 反向构造

既然是双射，当然可以从 prufer 序列推出原树。

根据 prufer 序列的性质，我们可以得到原树上每个点的度数。

每次我们选择一个编号最小的度数为 1 的节点，与当前枚举到的 prufer 序列的点连接，然后同时减掉两个点的度数。重复 $n-2$ 次后就只剩下两个度数为 1 的节点，其中一个是 $n$，把它们连接起来即可。

$O(n)$ 的构造方法，$p$ 指向当前编号最小的度数为 1 的节点，把它连接后可能会产生至多一个新的度数为 1 的节点 $x$，类似上面的过程，可以做到 $O(n)$。

**例题：**

[P6086 【模板】Prufer 序列](https://www.luogu.com.cn/problem/P6086)

